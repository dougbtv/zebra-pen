---
apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  name: quaggab
spec:
  containers:
    - name: quaggab
      image: dougbtv/quagga
      securityContext:
        privileged: true
      volumeMounts:
        - mountPath: /etc/quagga/
          name: config
  restartPolicy: Never
  volumes:
    - name: config
      configMap:
        name: quagga-config
        items:
        - key: ospfd.conf
          path: ospfd.conf
        - key: daemons
          path: daemons
        - key: vtysh.conf
          path: vtysh.conf
        - key: debian.conf
          path: debian.conf
status: {}
---
apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  name: centosb
spec:
  containers:
    - name: centosb
      image: dougbtv/centos-network
      securityContext:
        privileged: true
      command: ["/bin/bash", "-c", "while true; do sleep 2; done"]
---
apiVersion: v1
kind: ConfigMap
metadata:
  creationTimestamp: null
  name: quagga-config
data:
  ospfd.conf: |
    {% for interface in ospfd_interfaces %}interface {{ interface }}
    {% endfor %}
    router ospf
     ospf router-id {{ router_id }}
     redistribute static
     passive-interface {{ ospfd_passive_interface }}
     {% for network in ospfd_networks %} 
     network {{ network }} area 0.0.0.0
     {% endfor %}

    line vty
  daemons: |
    zebra=yes
    bgpd=no
    ospfd=yes
    ospf6d=no
    ripd=no
    ripngd=no
    isisd=no
  vtysh.conf: |
    
  debian.conf: | 
    #
    # If this option is set the /etc/init.d/quagga script automatically loads
    # the config via "vtysh -b" when the servers are started.
    # Check /etc/pam.d/quagga if you intend to use "vtysh"!
    #
    vtysh_enable=yes
    zebra_options="  -s 90000000 --daemon -A 127.0.0.1"
    bgpd_options="   --daemon -A 127.0.0.1"
    ospfd_options="  --daemon -A 127.0.0.1"
    ospf6d_options=" --daemon -A ::1"
    ripd_options="   --daemon -A 127.0.0.1"
    ripngd_options=" --daemon -A ::1"
    isisd_options="  --daemon -A 127.0.0.1"
    # The list of daemons to watch is automatically generated by the init script.
    watchquagga_enable=yes
    watchquagga_options=(-adz -r /usr/sbin/servicebBquaggabBrestartbB%s -s /usr/sbin/servicebBquaggabBstartbB%s -k /usr/sbin/servicebBquaggabBstopbB%s -b bB -t 30)
